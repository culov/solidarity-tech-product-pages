$(document).ready(function() {
    "use strict";
    var e = $("body");
    $(function() {
        $(".preloader").fadeOut(), $("#side-menu").metisMenu()
    }), $(".open-close").on("click", function() {
        e.toggleClass("show-sidebar").toggleClass("hide-sidebar"), $(".sidebar-head .open-close i").toggleClass("ti-menu")
    }), $(function() {

        //on new load --- delete when replacing with turbolinks/swup

        var i = function() {
                var i = 60,
                    o = window.innerWidth > 0 ? window.innerWidth : this.screen.width,
                    l = (window.innerHeight > 0 ? window.innerHeight : this.screen.height) - 1;
                768 > o ? ($("div.navbar-collapse").addClass("collapse"), i = 100) : $("div.navbar-collapse").removeClass("collapse"), 1170 > o ? (e.addClass("content-wrapper"), $(".sidebar-nav, .slimScrollDiv").css("overflow-x", "visible").parent().css("overflow", "visible")) : e.removeClass("content-wrapper"), l -= i, 1 > l && (l = 1), l > i && $("#page-wrapper").css("min-height", l + "px")
            },
            o = window.location,
            l = $("ul.nav a").filter(function() {
                return this.href.trim() === o.href.trim()
            }).addClass("active").parent().parent().addClass("in").parent();

        l.is("li") && l.addClass("active"), $(window).ready(i), $(window).bind("resize", i)


    }), $(function() {
        $(document).tooltip({ selector: '[data-toggle=tooltip]' })
    }), $(function() {
        $('[data-toggle="popover"]').popover()
    }), $(".list-task li label").on("click", function() {
        $(this).toggleClass("task-done")
    }), $(".settings_box a").on("click", function() {
        $("ul.theme_color").toggleClass("theme_block")
    }), $(".collapseble").on("click", function() {
        $(".collapseblebox").fadeToggle(350)
    }), $(".slimscrollright").slimScroll({
        height: "100%",
        position: "right",
        size: "5px",
        color: "#dcdcdc"
    }), $(".slimscrollsidebar").slimScroll({
        height: "100%",
        position: "right",
        size: "6px",
        color: "rgba(0,0,0,0.3)"
    }), $(".chat-list").slimScroll({
        height: "100%",
        position: "right",
        size: "0px",
        color: "#dcdcdc"
    }), e.trigger("resize"), $(".visited li a").on("click", function(e) {
        $(".visited li").removeClass("active");
        var i = $(this).parent();
        i.hasClass("active") || i.addClass("active"), e.preventDefault()
    }), $("#to-recover").on("click", function() {
        $("#loginform").slideUp(), $("#recoverform").fadeIn()
    }), $(".navbar-toggle").on("click", function() {
        $(".navbar-toggle i").toggleClass("ti-menu").addClass("ti-close")
    })

    $('.dropdown-submenu a.other_cities').on("click", function(e){
        $(this).next('ul').toggle();
        e.stopPropagation();
        e.preventDefault();
      });



});


function formatUser (user) {
  if (user.loading) {
    return user.text;
  }

  var $container = $(
    "<div class='select2-result-user-row clearfix'>" +
      "<div class='select2-result-repository__title'><span class='full_name'>"+user.name+"</span> <span class='username'>("+user.username+")</span></div>" +
    "</div>"
  );

  return $container || user.text;
}

function formatUserSelection (user) {
  return user.name || user.text;
}


$(document).on("turbolinks:load",function(e){
    "use strict";
    var e = $("body");
    var i = function() {
          var i = 60,
              o = window.innerWidth > 0 ? window.innerWidth : this.screen.width,
              l = (window.innerHeight > 0 ? window.innerHeight : this.screen.height) - 1;
          768 > o ? ($("div.navbar-collapse").addClass("collapse"), i = 100) : $("div.navbar-collapse").removeClass("collapse"), 1170 > o ? (e.addClass("content-wrapper"), $(".sidebar-nav, .slimScrollDiv").css("overflow-x", "visible").parent().css("overflow", "visible")) : e.removeClass("content-wrapper"), l -= i, 1 > l && (l = 1), l > i && $("#page-wrapper").css("min-height", l + "px")
      },
      o = window.location,
      l = $("ul.nav a").filter(function() {
          return this.href.trim() === o.href.trim()
      }).addClass("active").parent().parent().addClass("in").parent();

  l.is("li") && l.addClass("active"), $(window).ready(i), $(window).bind("resize", i)

})

var serializeHash = function () {
    var attrs = {};

    $.each($(this).serializeArray(), function(i, field) {
        attrs[field.name] = field.value;
    });

    return attrs;
};
$.fn.extend({ serializeHash: serializeHash });



function slugify(string) {
  const a = 'àáäâãåăæçèéëêǵḧìíïîḿńǹñòóöôœøṕŕßśșțùúüûǘẃẍÿź·/_,:;'
  const b = 'aaaaaaaaceeeeghiiiimnnnooooooprssstuuuuuwxyz------'
  const p = new RegExp(a.split('').join('|'), 'g')
  return string.toString().toLowerCase()
    .replace(/\s+/g, '-') // Replace spaces with -
    .replace(p, c => b.charAt(a.indexOf(c))) // Replace special characters
    .replace(/&/g, '-and-') // Replace & with ‘and’
    .replace(/[^\w\-]+/g, '') // Remove all non-word characters
    .replace(/\-\-+/g, '-') // Replace multiple - with single -
    .replace(/^-+/, '') // Trim - from start of text
    // .replace(/-+$/, '') // Trim - from end of text
}